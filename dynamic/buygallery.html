<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Buy & Sell Used Smartphones, Laptops & Tablets | SellInSeconds</title>

  <!-- Default meta; will be updated dynamically for the first image -->
  <meta name="description" content="" id="page-desc" />
  <meta property="og:image" content="" id="og-image" />
  <meta name="twitter:image" content="" id="tw-image" />

  <link rel="canonical" href="https://www.sellinseconds.in/dynamic/buygallery.html" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://www.sellinseconds.in/fevicon.ico" rel="icon" type="image/x-icon" />

  <style>
    /*— Your existing styles —*/
    body { font-family: 'Segoe UI', Tahoma, sans-serif; background: linear-gradient(135deg, #f0f2f5, #e6e9ef); margin:0;padding:0;}
    .container { max-width:1400px;margin:auto;padding:1rem; }
    .gallery-grid { display:grid; gap:1.5rem; grid-template-columns:1fr; padding-top:1rem;}
    @media(min-width:768px){.gallery-grid{grid-template-columns:repeat(3,1fr);}}
    .card-img-container {width:100%;aspect-ratio:4/3;position:relative;overflow:hidden;background-color:#fff;}
    .card-img-container img {position:absolute;top:0;left:0;width:100%;height:100%;object-fit:contain;padding:10px;}
    .card-wrapper {background:#fff;border-radius:12px;overflow:hidden;position:relative;box-shadow:0 0 0 3px #e0e0e0,0 0 0 6px var(--card-border-color,#b3d9ff),0 6px 18px rgba(0,0,0,0.1);transition:.3s ease;}
    .card-wrapper:hover{transform:translateY(-8px);}
    .card-wrapper.top-most {--card-border-color:#007bff;}
    .card-wrapper.top-most::before {content:'NEWLY ADDED';position:absolute;top:10px;right:-10px;background-color:#ff4d4d;color:white;padding:5px 15px;font-size:.8rem;font-weight:bold;border-radius:5px;transform:rotate(20deg) scaleX(0);transform-origin:center center;box-shadow:0 2px 5px rgba(0,0,0,0.2);z-index:10;}
    .card-wrapper.top-most.animate-badge::before {animation:flipIn 1s forwards;}
    @keyframes flipIn {0%{transform:rotate(20deg) scaleX(0);}50%{transform:rotate(20deg) scaleX(1.2);}100%{transform:rotate(20deg) scaleX(1);}}
    .card-actions {display:flex;justify-content:space-around;padding:1rem;}
    .action-btn {color:#fff;padding:.6rem 1rem;border-radius:8px;text-decoration:none;font-weight:bold;display:flex;align-items:center;gap:.5rem;transition:background-color .3s ease,box-shadow .3s ease;}
    .whatsapp-action-btn {background-color:#25d366;}
    .call-action-btn {background-color:#007bff;}
    .action-btn.glow {animation:glow 1.5s infinite alternate;}
    .whatsapp-action-btn.glow {box-shadow:0 0 20px 8px rgba(255,0,255,0.8)!important;}
    .call-action-btn.glow {box-shadow:0 0 20px 8px rgba(255,165,0,0.8)!important;}
    @keyframes glow{0%{box-shadow:0 0 10px 4px rgba(255,255,255,0.7)!important;}100%{box-shadow:0 0 30px 10px rgba(255,255,255,1)!important;}}
  </style>
</head>
<body>
  <div class="container">
    <div class="gallery-grid" id="gallery"></div>
  </div>

  <script>
    const DATA_URL = '/dynamic/imagedata.json';
    const IMAGE_BASE = 'https://www.sellinseconds.in/dynamic/images/';
    let observer;

    async function loadGallery() {
      try {
        const res = await fetch(DATA_URL, {cache:'no-store'});
        const json = await res.json();

        const seq = json.sequences[json.active];
        const imageMap = {};
        json.images.forEach(img => imageMap[img.id] = img);

        const gallery = document.getElementById('gallery');
        gallery.innerHTML = seq.map((id, idx) => {
          const img = imageMap[id] || {name:`Image ${id}`, description:''};
          const imgSrc = `${IMAGE_BASE}${id}.webp?_=${Date.now()}`;
          const shareText = `Interested in: ${img.name} - ${img.description}\nhttps://www.sellinseconds.in/dynamic/wacust/${id}.html`;

          // inject meta tags using the first image
          if (idx === 0) {
            document.getElementById('page-desc').setAttribute('content', img.description);
            document.getElementById('og-image').setAttribute('content', imgSrc);
            document.getElementById('tw-image').setAttribute('content', imgSrc);
          }

          return `
            <div class="card-wrapper ${idx===0?'top-most':''}" data-image-id="${id}">
              <div class="card-img-container">
                <img src="${imgSrc}" alt="${img.name} - ${img.description}" loading="lazy" onerror="this.closest('.card-wrapper').style.display='none';">
              </div>
              <div class="card-actions">
                <a href="https://wa.me/919886566379?text=${encodeURIComponent(shareText)}" target="_blank" class="action-btn whatsapp-action-btn">
                  <i class="fab fa-whatsapp"></i> I'm Interested
                </a>
                <a href="tel:+919886566379" class="action-btn call-action-btn">
                  <i class="fas fa-phone"></i> Call Now
                </a>
              </div>
            </div>`;
        }).join('');

        handleAnimation();
        setTimeout(setupObserver, 500);

      } catch (err) {
        console.error('Failed to load gallery:', err);
      }
    }

    function handleAnimation() {
      const top = document.querySelector('.card-wrapper.top-most');
      const mobilePortrait = window.innerWidth < 600 && window.innerHeight > window.innerWidth;

      if (mobilePortrait && document.body.scrollHeight > window.innerHeight + 100) {
        setTimeout(() => {
          window.scrollTo({top: 150, behavior: 'smooth'});
          setTimeout(() => {
            window.scrollTo({top: 0, behavior: 'smooth'});
            if (top) top.classList.add('animate-badge');
          }, 1500);
        }, 1000);
      } else if (top) {
        setTimeout(() => top.classList.add('animate-badge'), 500);
      }
    }

    function setupObserver() {
      const cards = document.querySelectorAll('.card-wrapper');
      if (!cards.length) return setTimeout(setupObserver, 1000);

      observer?.disconnect();
      observer = new IntersectionObserver(entries => {
        entries.forEach(e => {
          const btns = e.target.querySelectorAll('.action-btn');
          btns.forEach(btn => btn.classList.toggle('glow', e.isIntersecting));
        });
      }, {root:null, rootMargin:'-40% 0 -40% 0', threshold:0.01});

      cards.forEach(c => observer.observe(c));
    }

    window.addEventListener('DOMContentLoaded', loadGallery);
  </script>
</body>
</html>